{"ast":null,"code":"/*! JointJS+ v4.0.0 - HTML5 Diagramming Framework - TRIAL VERSION\n\nCopyright (c) 2024 client IO\n\n 2024-02-18 \n\n\nThis Source Code Form is subject to the terms of the JointJS+ Trial License\n, v. 2.0. If a copy of the JointJS+ License was not distributed with this\nfile, You can obtain one at https://www.jointjs.com/license\n or from the JointJS+ archive as was distributed by client IO. See the LICENSE file.*/\n\nimport { dia, shapes, ui } from '@joint/plus';\nimport { enableVirtualRendering } from './features/virtual-rendering';\nimport { toolbarConfig } from './config/toolbar.config';\nimport { BACKGROUND_COLOR, SECONDARY_BACKGROUND_COLOR, GRID_SIZE, PADDING_L, PADDING_S } from '../theme';\nimport './shapes/index';\nexport function createPlugins(scopeElement, paperElement, stencilElement, toolbarElement) {\n  // Graph\n  // https://resources.jointjs.com/docs/jointjs/v3.1/joint.html#dia.Graph\n  const graph = new dia.Graph({}, {\n    cellNamespace: shapes\n  });\n\n  // Paper\n  // https://resources.jointjs.com/docs/jointjs/v3.1/joint.html#dia.Paper\n  const paper = new dia.Paper({\n    model: graph,\n    async: true,\n    sorting: dia.Paper.sorting.APPROX,\n    gridSize: GRID_SIZE,\n    linkPinning: false,\n    multiLinks: false,\n    snapLinks: true,\n    moveThreshold: 5,\n    magnetThreshold: 'onleave',\n    background: {\n      color: BACKGROUND_COLOR\n    },\n    cellViewNamespace: shapes,\n    interactive: {\n      labelMove: true,\n      linkMove: false\n    },\n    defaultRouter: {\n      name: 'manhattan',\n      args: {\n        padding: {\n          bottom: PADDING_L,\n          vertical: PADDING_S,\n          horizontal: PADDING_S\n        },\n        step: GRID_SIZE\n      }\n    },\n    defaultConnector: {\n      name: 'rounded'\n    },\n    defaultLink: () => new shapes.app.Link(),\n    validateConnection: (sourceView, sourceMagnet, targetView, targetMagnet) => {\n      if (sourceView === targetView) return false;\n      if (targetView.findAttribute('port-group', targetMagnet) !== 'in') return false;\n      if (sourceView.findAttribute('port-group', sourceMagnet) !== 'out') return false;\n      return true;\n    }\n  });\n\n  // PaperScroller Plugin (Scroll & Zoom)\n  // https://resources.jointjs.com/docs/rappid/v3.1/ui.html#ui.PaperScroller\n  const scroller = new ui.PaperScroller({\n    paper,\n    autoResizePaper: true,\n    contentOptions: {\n      padding: 100,\n      allowNewOrigin: 'any',\n      allowNegativeBottomRight: true,\n      useModelGeometry: true\n    },\n    scrollWhileDragging: true,\n    cursor: 'grab',\n    baseWidth: 1000,\n    baseHeight: 1000\n  });\n  paperElement.appendChild(scroller.el);\n  scroller.render().center();\n\n  // Render what the user sees, keeping the number of rendered cells to the minimum.\n  enableVirtualRendering(scroller, {\n    threshold: 50\n  });\n\n  // Stencil Plugin (Element Palette)\n  // https://resources.jointjs.com/docs/rappid/v3.1/ui.html#ui.Stencil\n  const stencil = new ui.Stencil({\n    paper: scroller,\n    width: 240,\n    scaleClones: true,\n    dropAnimation: true,\n    paperOptions: {\n      sorting: dia.Paper.sorting.NONE,\n      background: {\n        color: SECONDARY_BACKGROUND_COLOR\n      }\n    },\n    dragStartClone: element => {\n      const name = element.get('name');\n      // @ts-ignore\n      const Shape = shapes.app[name];\n      if (!Shape) throw new Error(`Invalid stencil shape name: ${name}`);\n      return Shape.fromStencilShape(element);\n    },\n    layout: {\n      columnWidth: 110,\n      columns: 1,\n      rowGap: PADDING_S,\n      rowHeight: 'auto',\n      marginY: PADDING_S,\n      marginX: -PADDING_L\n    }\n  });\n  stencilElement.appendChild(stencil.el);\n  stencil.render();\n\n  // Command Manager Plugin (Undo / Redo)\n  // https://resources.jointjs.com/docs/rappid/v3.1/dia.html#dia.CommandManager\n  const history = new dia.CommandManager({\n    graph\n  });\n\n  // Toolbar Plugin\n  // https://resources.jointjs.com/docs/rappid/v3.1/ui.html#ui.Toolbar\n  const toolbar = new ui.Toolbar({\n    tools: toolbarConfig.tools,\n    autoToggle: true,\n    references: {\n      paperScroller: scroller,\n      commandManager: history\n    }\n  });\n  toolbarElement.appendChild(toolbar.el);\n  toolbar.render();\n\n  // Tooltip plugin\n  // https://resources.jointjs.com/docs/rappid/v3.1/ui.html#ui.Tooltip\n  const tooltip = new ui.Tooltip({\n    rootTarget: scopeElement,\n    container: scopeElement,\n    target: '[data-tooltip]',\n    direction: ui.Tooltip.TooltipArrowPosition.Auto,\n    padding: PADDING_S,\n    animation: true\n  });\n\n  // Keyboard plugin\n  // https://resources.jointjs.com/docs/rappid/v3.1/ui.html#ui.Keyboard\n  const keyboard = new ui.Keyboard();\n  return {\n    graph,\n    paper,\n    scroller,\n    stencil,\n    toolbar,\n    tooltip,\n    keyboard,\n    history\n  };\n}","map":{"version":3,"names":["dia","shapes","ui","enableVirtualRendering","toolbarConfig","BACKGROUND_COLOR","SECONDARY_BACKGROUND_COLOR","GRID_SIZE","PADDING_L","PADDING_S","createPlugins","scopeElement","paperElement","stencilElement","toolbarElement","graph","Graph","cellNamespace","paper","Paper","model","async","sorting","APPROX","gridSize","linkPinning","multiLinks","snapLinks","moveThreshold","magnetThreshold","background","color","cellViewNamespace","interactive","labelMove","linkMove","defaultRouter","name","args","padding","bottom","vertical","horizontal","step","defaultConnector","defaultLink","app","Link","validateConnection","sourceView","sourceMagnet","targetView","targetMagnet","findAttribute","scroller","PaperScroller","autoResizePaper","contentOptions","allowNewOrigin","allowNegativeBottomRight","useModelGeometry","scrollWhileDragging","cursor","baseWidth","baseHeight","appendChild","el","render","center","threshold","stencil","Stencil","width","scaleClones","dropAnimation","paperOptions","NONE","dragStartClone","element","get","Shape","Error","fromStencilShape","layout","columnWidth","columns","rowGap","rowHeight","marginY","marginX","history","CommandManager","toolbar","Toolbar","tools","autoToggle","references","paperScroller","commandManager","tooltip","Tooltip","rootTarget","container","target","direction","TooltipArrowPosition","Auto","animation","keyboard","Keyboard"],"sources":["/Users/guankaiyuan/ReactTs/src/joint-plus/plugins.ts"],"sourcesContent":["/*! JointJS+ v4.0.0 - HTML5 Diagramming Framework - TRIAL VERSION\n\nCopyright (c) 2024 client IO\n\n 2024-02-18 \n\n\nThis Source Code Form is subject to the terms of the JointJS+ Trial License\n, v. 2.0. If a copy of the JointJS+ License was not distributed with this\nfile, You can obtain one at https://www.jointjs.com/license\n or from the JointJS+ archive as was distributed by client IO. See the LICENSE file.*/\n\n\nimport { dia, shapes, ui } from '@joint/plus';\n\nimport { enableVirtualRendering } from './features/virtual-rendering';\nimport { toolbarConfig } from './config/toolbar.config';\nimport { BACKGROUND_COLOR, SECONDARY_BACKGROUND_COLOR, GRID_SIZE, PADDING_L, PADDING_S } from '../theme';\nimport './shapes/index';\n\nexport function createPlugins(\n    scopeElement: Element,\n    paperElement: Element,\n    stencilElement: Element,\n    toolbarElement: Element\n) {\n    // Graph\n    // https://resources.jointjs.com/docs/jointjs/v3.1/joint.html#dia.Graph\n    const graph = new dia.Graph({}, { cellNamespace: shapes });\n\n    // Paper\n    // https://resources.jointjs.com/docs/jointjs/v3.1/joint.html#dia.Paper\n    const paper = new dia.Paper({\n        model: graph,\n        async: true,\n        sorting: dia.Paper.sorting.APPROX,\n        gridSize: GRID_SIZE,\n        linkPinning: false,\n        multiLinks: false,\n        snapLinks: true,\n        moveThreshold: 5,\n        magnetThreshold: 'onleave',\n        background: { color: BACKGROUND_COLOR },\n        cellViewNamespace: shapes,\n        interactive: {\n            labelMove: true,\n            linkMove: false\n        },\n        defaultRouter: {\n            name: 'manhattan',\n            args: {\n                padding: { bottom: PADDING_L, vertical: PADDING_S, horizontal: PADDING_S },\n                step: GRID_SIZE\n            }\n        },\n        defaultConnector: {\n            name: 'rounded'\n        },\n        defaultLink: () => new shapes.app.Link(),\n        validateConnection: (\n            sourceView: dia.CellView,\n            sourceMagnet: SVGElement,\n            targetView: dia.CellView,\n            targetMagnet: SVGElement\n        ) => {\n            if (sourceView === targetView) return false;\n            if (targetView.findAttribute('port-group', targetMagnet) !== 'in') return false;\n            if (sourceView.findAttribute('port-group', sourceMagnet) !== 'out') return false;\n            return true;\n        }\n    });\n\n    // PaperScroller Plugin (Scroll & Zoom)\n    // https://resources.jointjs.com/docs/rappid/v3.1/ui.html#ui.PaperScroller\n    const scroller = new ui.PaperScroller({\n        paper,\n        autoResizePaper: true,\n        contentOptions: {\n            padding: 100,\n            allowNewOrigin: 'any',\n            allowNegativeBottomRight: true,\n            useModelGeometry: true\n        },\n        scrollWhileDragging: true,\n        cursor: 'grab',\n        baseWidth: 1000,\n        baseHeight: 1000\n    });\n    paperElement.appendChild(scroller.el);\n    scroller.render().center();\n\n    // Render what the user sees, keeping the number of rendered cells to the minimum.\n    enableVirtualRendering(scroller, { threshold: 50 });\n\n    // Stencil Plugin (Element Palette)\n    // https://resources.jointjs.com/docs/rappid/v3.1/ui.html#ui.Stencil\n    const stencil = new ui.Stencil({\n        paper: scroller,\n        width: 240,\n        scaleClones: true,\n        dropAnimation: true,\n        paperOptions: {\n            sorting: dia.Paper.sorting.NONE,\n            background: {\n                color: SECONDARY_BACKGROUND_COLOR\n            }\n        },\n        dragStartClone: (element: dia.Element) => {\n            const name = element.get('name');\n            // @ts-ignore\n            const Shape = shapes.app[name];\n            if (!Shape) throw new Error(`Invalid stencil shape name: ${name}`);\n            return Shape.fromStencilShape(element);\n        },\n        layout: {\n            columnWidth: 110,\n            columns: 1,\n            rowGap: PADDING_S,\n            rowHeight: 'auto',\n            marginY: PADDING_S,\n            marginX: -PADDING_L\n        }\n    });\n    stencilElement.appendChild(stencil.el);\n    stencil.render();\n\n    // Command Manager Plugin (Undo / Redo)\n    // https://resources.jointjs.com/docs/rappid/v3.1/dia.html#dia.CommandManager\n    const history = new dia.CommandManager({\n        graph\n    });\n\n    // Toolbar Plugin\n    // https://resources.jointjs.com/docs/rappid/v3.1/ui.html#ui.Toolbar\n    const toolbar = new ui.Toolbar({\n        tools: toolbarConfig.tools,\n        autoToggle: true,\n        references: {\n            paperScroller: scroller,\n            commandManager: history\n        }\n    });\n    toolbarElement.appendChild(toolbar.el);\n    toolbar.render();\n\n    // Tooltip plugin\n    // https://resources.jointjs.com/docs/rappid/v3.1/ui.html#ui.Tooltip\n    const tooltip = new ui.Tooltip({\n        rootTarget: scopeElement,\n        container: scopeElement,\n        target: '[data-tooltip]',\n        direction: ui.Tooltip.TooltipArrowPosition.Auto,\n        padding: PADDING_S,\n        animation: true\n    });\n\n    // Keyboard plugin\n    // https://resources.jointjs.com/docs/rappid/v3.1/ui.html#ui.Keyboard\n    const keyboard = new ui.Keyboard();\n\n    return { graph, paper, scroller, stencil, toolbar, tooltip, keyboard, history };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}