{"ast":null,"code":"import * as g from '../g/index.mjs';\nimport V from '../V/index.mjs';\nimport * as util from '../util/index.mjs';\nimport { ToolView } from '../dia/ToolView.mjs';\n\n// End Markers\nconst Arrowhead = ToolView.extend({\n  tagName: 'path',\n  xAxisVector: new g.Point(1, 0),\n  events: {\n    mousedown: 'onPointerDown',\n    touchstart: 'onPointerDown'\n  },\n  documentEvents: {\n    mousemove: 'onPointerMove',\n    touchmove: 'onPointerMove',\n    mouseup: 'onPointerUp',\n    touchend: 'onPointerUp',\n    touchcancel: 'onPointerUp'\n  },\n  options: {\n    scale: null\n  },\n  onRender: function () {\n    this.update();\n  },\n  update: function () {\n    var ratio = this.ratio;\n    var view = this.relatedView;\n    var tangent = view.getTangentAtRatio(ratio);\n    var position, angle;\n    if (tangent) {\n      position = tangent.start;\n      angle = tangent.vector().vectorAngle(this.xAxisVector) || 0;\n    } else {\n      position = view.getPointAtRatio(ratio);\n      angle = 0;\n    }\n    if (!position) return this;\n    var matrix = V.createSVGMatrix().translate(position.x, position.y).rotate(angle);\n    const {\n      scale\n    } = this.options;\n    if (scale) matrix = matrix.scale(scale);\n    this.vel.transform(matrix, {\n      absolute: true\n    });\n    return this;\n  },\n  onPointerDown: function (evt) {\n    if (this.guard(evt)) return;\n    evt.stopPropagation();\n    evt.preventDefault();\n    var relatedView = this.relatedView;\n    relatedView.model.startBatch('arrowhead-move', {\n      ui: true,\n      tool: this.cid\n    });\n    relatedView.startArrowheadMove(this.arrowheadType);\n    this.delegateDocumentEvents();\n    relatedView.paper.undelegateEvents();\n    this.focus();\n    this.el.style.pointerEvents = 'none';\n  },\n  onPointerMove: function (evt) {\n    var normalizedEvent = util.normalizeEvent(evt);\n    var coords = this.paper.snapToGrid(normalizedEvent.clientX, normalizedEvent.clientY);\n    this.relatedView.pointermove(normalizedEvent, coords.x, coords.y);\n  },\n  onPointerUp: function (evt) {\n    this.undelegateDocumentEvents();\n    var relatedView = this.relatedView;\n    var paper = relatedView.paper;\n    var normalizedEvent = util.normalizeEvent(evt);\n    var coords = paper.snapToGrid(normalizedEvent.clientX, normalizedEvent.clientY);\n    relatedView.pointerup(normalizedEvent, coords.x, coords.y);\n    paper.delegateEvents();\n    this.blur();\n    this.el.style.pointerEvents = '';\n    relatedView.model.stopBatch('arrowhead-move', {\n      ui: true,\n      tool: this.cid\n    });\n  }\n});\nexport const TargetArrowhead = Arrowhead.extend({\n  name: 'target-arrowhead',\n  ratio: 1,\n  arrowheadType: 'target',\n  attributes: {\n    'd': 'M -10 -8 10 0 -10 8 Z',\n    'fill': '#33334F',\n    'stroke': '#FFFFFF',\n    'stroke-width': 2,\n    'cursor': 'move',\n    'class': 'target-arrowhead'\n  }\n});\nexport const SourceArrowhead = Arrowhead.extend({\n  name: 'source-arrowhead',\n  ratio: 0,\n  arrowheadType: 'source',\n  attributes: {\n    'd': 'M 10 -8 -10 0 10 8 Z',\n    'fill': '#33334F',\n    'stroke': '#FFFFFF',\n    'stroke-width': 2,\n    'cursor': 'move',\n    'class': 'source-arrowhead'\n  }\n});","map":{"version":3,"names":["g","V","util","ToolView","Arrowhead","extend","tagName","xAxisVector","Point","events","mousedown","touchstart","documentEvents","mousemove","touchmove","mouseup","touchend","touchcancel","options","scale","onRender","update","ratio","view","relatedView","tangent","getTangentAtRatio","position","angle","start","vector","vectorAngle","getPointAtRatio","matrix","createSVGMatrix","translate","x","y","rotate","vel","transform","absolute","onPointerDown","evt","guard","stopPropagation","preventDefault","model","startBatch","ui","tool","cid","startArrowheadMove","arrowheadType","delegateDocumentEvents","paper","undelegateEvents","focus","el","style","pointerEvents","onPointerMove","normalizedEvent","normalizeEvent","coords","snapToGrid","clientX","clientY","pointermove","onPointerUp","undelegateDocumentEvents","pointerup","delegateEvents","blur","stopBatch","TargetArrowhead","name","attributes","SourceArrowhead"],"sources":["/Users/guankaiyuan/ReactTs/node_modules/.pnpm/@joint+core@4.0.1/node_modules/@joint/core/src/linkTools/Arrowhead.mjs"],"sourcesContent":["import * as g from '../g/index.mjs';\nimport V from '../V/index.mjs';\nimport * as util from '../util/index.mjs';\nimport { ToolView } from '../dia/ToolView.mjs';\n\n// End Markers\nconst Arrowhead = ToolView.extend({\n    tagName: 'path',\n    xAxisVector: new g.Point(1, 0),\n    events: {\n        mousedown: 'onPointerDown',\n        touchstart: 'onPointerDown'\n    },\n    documentEvents: {\n        mousemove: 'onPointerMove',\n        touchmove: 'onPointerMove',\n        mouseup: 'onPointerUp',\n        touchend: 'onPointerUp',\n        touchcancel: 'onPointerUp'\n    },\n    options: {\n        scale: null\n    },\n    onRender: function() {\n        this.update();\n    },\n    update: function() {\n        var ratio = this.ratio;\n        var view = this.relatedView;\n        var tangent = view.getTangentAtRatio(ratio);\n        var position, angle;\n        if (tangent) {\n            position = tangent.start;\n            angle = tangent.vector().vectorAngle(this.xAxisVector) || 0;\n        } else {\n            position = view.getPointAtRatio(ratio);\n            angle = 0;\n        }\n        if (!position) return this;\n        var matrix = V.createSVGMatrix().translate(position.x, position.y).rotate(angle);\n        const { scale } = this.options;\n        if (scale) matrix = matrix.scale(scale);\n        this.vel.transform(matrix, { absolute: true });\n        return this;\n    },\n    onPointerDown: function(evt) {\n        if (this.guard(evt)) return;\n        evt.stopPropagation();\n        evt.preventDefault();\n        var relatedView = this.relatedView;\n        relatedView.model.startBatch('arrowhead-move', { ui: true, tool: this.cid });\n        relatedView.startArrowheadMove(this.arrowheadType);\n        this.delegateDocumentEvents();\n        relatedView.paper.undelegateEvents();\n        this.focus();\n        this.el.style.pointerEvents = 'none';\n    },\n    onPointerMove: function(evt) {\n        var normalizedEvent = util.normalizeEvent(evt);\n        var coords = this.paper.snapToGrid(normalizedEvent.clientX, normalizedEvent.clientY);\n        this.relatedView.pointermove(normalizedEvent, coords.x, coords.y);\n    },\n    onPointerUp: function(evt) {\n        this.undelegateDocumentEvents();\n        var relatedView = this.relatedView;\n        var paper = relatedView.paper;\n        var normalizedEvent = util.normalizeEvent(evt);\n        var coords = paper.snapToGrid(normalizedEvent.clientX, normalizedEvent.clientY);\n        relatedView.pointerup(normalizedEvent, coords.x, coords.y);\n        paper.delegateEvents();\n        this.blur();\n        this.el.style.pointerEvents = '';\n        relatedView.model.stopBatch('arrowhead-move', { ui: true, tool: this.cid });\n    }\n});\n\nexport const TargetArrowhead = Arrowhead.extend({\n    name: 'target-arrowhead',\n    ratio: 1,\n    arrowheadType: 'target',\n    attributes: {\n        'd': 'M -10 -8 10 0 -10 8 Z',\n        'fill': '#33334F',\n        'stroke': '#FFFFFF',\n        'stroke-width': 2,\n        'cursor': 'move',\n        'class': 'target-arrowhead'\n    }\n});\n\nexport const SourceArrowhead = Arrowhead.extend({\n    name: 'source-arrowhead',\n    ratio: 0,\n    arrowheadType: 'source',\n    attributes: {\n        'd': 'M 10 -8 -10 0 10 8 Z',\n        'fill': '#33334F',\n        'stroke': '#FFFFFF',\n        'stroke-width': 2,\n        'cursor': 'move',\n        'class': 'source-arrowhead'\n    }\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}