{"ast":null,"code":"import { View } from '../mvc/index.mjs';\nimport { addClassNamePrefix } from '../util/util.mjs';\nexport const LayersNames = {\n  GRID: 'grid',\n  CELLS: 'cells',\n  BACK: 'back',\n  FRONT: 'front',\n  TOOLS: 'tools',\n  LABELS: 'labels'\n};\nexport const PaperLayer = View.extend({\n  tagName: 'g',\n  svgElement: true,\n  pivotNodes: null,\n  defaultTheme: null,\n  options: {\n    name: ''\n  },\n  className: function () {\n    return addClassNamePrefix(`${this.options.name}-layer`);\n  },\n  init: function () {\n    this.pivotNodes = {};\n  },\n  insertSortedNode: function (node, z) {\n    this.el.insertBefore(node, this.insertPivot(z));\n  },\n  insertNode: function (node) {\n    const {\n      el\n    } = this;\n    if (node.parentNode !== el) {\n      el.appendChild(node);\n    }\n  },\n  insertPivot: function (z) {\n    const {\n      el,\n      pivotNodes\n    } = this;\n    z = +z;\n    z || (z = 0);\n    let pivotNode = pivotNodes[z];\n    if (pivotNode) return pivotNode;\n    pivotNode = pivotNodes[z] = document.createComment('z-index:' + (z + 1));\n    let neighborZ = -Infinity;\n    for (let currentZ in pivotNodes) {\n      currentZ = +currentZ;\n      if (currentZ < z && currentZ > neighborZ) {\n        neighborZ = currentZ;\n        if (neighborZ === z - 1) continue;\n      }\n    }\n    if (neighborZ !== -Infinity) {\n      const neighborPivot = pivotNodes[neighborZ];\n      // Insert After\n      el.insertBefore(pivotNode, neighborPivot.nextSibling);\n    } else {\n      // First Child\n      el.insertBefore(pivotNode, el.firstChild);\n    }\n    return pivotNode;\n  },\n  removePivots: function () {\n    const {\n      el,\n      pivotNodes\n    } = this;\n    for (let z in pivotNodes) el.removeChild(pivotNodes[z]);\n    this.pivotNodes = {};\n  }\n});","map":{"version":3,"names":["View","addClassNamePrefix","LayersNames","GRID","CELLS","BACK","FRONT","TOOLS","LABELS","PaperLayer","extend","tagName","svgElement","pivotNodes","defaultTheme","options","name","className","init","insertSortedNode","node","z","el","insertBefore","insertPivot","insertNode","parentNode","appendChild","pivotNode","document","createComment","neighborZ","Infinity","currentZ","neighborPivot","nextSibling","firstChild","removePivots","removeChild"],"sources":["/Users/guankaiyuan/ReactTs/node_modules/.pnpm/@joint+core@4.0.1/node_modules/@joint/core/src/dia/PaperLayer.mjs"],"sourcesContent":["import { View } from '../mvc/index.mjs';\nimport { addClassNamePrefix } from '../util/util.mjs';\n\nexport const LayersNames = {\n    GRID: 'grid',\n    CELLS: 'cells',\n    BACK: 'back',\n    FRONT: 'front',\n    TOOLS: 'tools',\n    LABELS: 'labels'\n};\n\nexport const PaperLayer = View.extend({\n\n    tagName: 'g',\n    svgElement: true,\n    pivotNodes: null,\n    defaultTheme: null,\n\n    options: {\n        name: ''\n    },\n\n    className: function() {\n        return addClassNamePrefix(`${this.options.name}-layer`);\n    },\n\n    init: function() {\n        this.pivotNodes = {};\n    },\n\n    insertSortedNode: function(node, z) {\n        this.el.insertBefore(node, this.insertPivot(z));\n    },\n\n    insertNode: function(node) {\n        const { el } = this;\n        if (node.parentNode !== el) {\n            el.appendChild(node);\n        }\n    },\n\n    insertPivot: function(z) {\n        const { el, pivotNodes } = this;\n        z = +z;\n        z || (z = 0);\n        let pivotNode = pivotNodes[z];\n        if (pivotNode) return pivotNode;\n        pivotNode = pivotNodes[z] = document.createComment('z-index:' + (z + 1));\n        let neighborZ = -Infinity;\n        for (let currentZ in pivotNodes) {\n            currentZ = +currentZ;\n            if (currentZ < z && currentZ > neighborZ) {\n                neighborZ = currentZ;\n                if (neighborZ === z - 1) continue;\n            }\n        }\n        if (neighborZ !== -Infinity) {\n            const neighborPivot = pivotNodes[neighborZ];\n            // Insert After\n            el.insertBefore(pivotNode, neighborPivot.nextSibling);\n        } else {\n            // First Child\n            el.insertBefore(pivotNode, el.firstChild);\n        }\n        return pivotNode;\n    },\n\n    removePivots: function() {\n        const { el, pivotNodes } = this;\n        for (let z in pivotNodes) el.removeChild(pivotNodes[z]);\n        this.pivotNodes = {};\n    }\n\n});\n"],"mappings":"AAAA,SAASA,IAAI,QAAQ,kBAAkB;AACvC,SAASC,kBAAkB,QAAQ,kBAAkB;AAErD,OAAO,MAAMC,WAAW,GAAG;EACvBC,IAAI,EAAE,MAAM;EACZC,KAAK,EAAE,OAAO;EACdC,IAAI,EAAE,MAAM;EACZC,KAAK,EAAE,OAAO;EACdC,KAAK,EAAE,OAAO;EACdC,MAAM,EAAE;AACZ,CAAC;AAED,OAAO,MAAMC,UAAU,GAAGT,IAAI,CAACU,MAAM,CAAC;EAElCC,OAAO,EAAE,GAAG;EACZC,UAAU,EAAE,IAAI;EAChBC,UAAU,EAAE,IAAI;EAChBC,YAAY,EAAE,IAAI;EAElBC,OAAO,EAAE;IACLC,IAAI,EAAE;EACV,CAAC;EAEDC,SAAS,EAAE,SAAAA,CAAA,EAAW;IAClB,OAAOhB,kBAAkB,CAAE,GAAE,IAAI,CAACc,OAAO,CAACC,IAAK,QAAO,CAAC;EAC3D,CAAC;EAEDE,IAAI,EAAE,SAAAA,CAAA,EAAW;IACb,IAAI,CAACL,UAAU,GAAG,CAAC,CAAC;EACxB,CAAC;EAEDM,gBAAgB,EAAE,SAAAA,CAASC,IAAI,EAAEC,CAAC,EAAE;IAChC,IAAI,CAACC,EAAE,CAACC,YAAY,CAACH,IAAI,EAAE,IAAI,CAACI,WAAW,CAACH,CAAC,CAAC,CAAC;EACnD,CAAC;EAEDI,UAAU,EAAE,SAAAA,CAASL,IAAI,EAAE;IACvB,MAAM;MAAEE;IAAG,CAAC,GAAG,IAAI;IACnB,IAAIF,IAAI,CAACM,UAAU,KAAKJ,EAAE,EAAE;MACxBA,EAAE,CAACK,WAAW,CAACP,IAAI,CAAC;IACxB;EACJ,CAAC;EAEDI,WAAW,EAAE,SAAAA,CAASH,CAAC,EAAE;IACrB,MAAM;MAAEC,EAAE;MAAET;IAAW,CAAC,GAAG,IAAI;IAC/BQ,CAAC,GAAG,CAACA,CAAC;IACNA,CAAC,KAAKA,CAAC,GAAG,CAAC,CAAC;IACZ,IAAIO,SAAS,GAAGf,UAAU,CAACQ,CAAC,CAAC;IAC7B,IAAIO,SAAS,EAAE,OAAOA,SAAS;IAC/BA,SAAS,GAAGf,UAAU,CAACQ,CAAC,CAAC,GAAGQ,QAAQ,CAACC,aAAa,CAAC,UAAU,IAAIT,CAAC,GAAG,CAAC,CAAC,CAAC;IACxE,IAAIU,SAAS,GAAG,CAACC,QAAQ;IACzB,KAAK,IAAIC,QAAQ,IAAIpB,UAAU,EAAE;MAC7BoB,QAAQ,GAAG,CAACA,QAAQ;MACpB,IAAIA,QAAQ,GAAGZ,CAAC,IAAIY,QAAQ,GAAGF,SAAS,EAAE;QACtCA,SAAS,GAAGE,QAAQ;QACpB,IAAIF,SAAS,KAAKV,CAAC,GAAG,CAAC,EAAE;MAC7B;IACJ;IACA,IAAIU,SAAS,KAAK,CAACC,QAAQ,EAAE;MACzB,MAAME,aAAa,GAAGrB,UAAU,CAACkB,SAAS,CAAC;MAC3C;MACAT,EAAE,CAACC,YAAY,CAACK,SAAS,EAAEM,aAAa,CAACC,WAAW,CAAC;IACzD,CAAC,MAAM;MACH;MACAb,EAAE,CAACC,YAAY,CAACK,SAAS,EAAEN,EAAE,CAACc,UAAU,CAAC;IAC7C;IACA,OAAOR,SAAS;EACpB,CAAC;EAEDS,YAAY,EAAE,SAAAA,CAAA,EAAW;IACrB,MAAM;MAAEf,EAAE;MAAET;IAAW,CAAC,GAAG,IAAI;IAC/B,KAAK,IAAIQ,CAAC,IAAIR,UAAU,EAAES,EAAE,CAACgB,WAAW,CAACzB,UAAU,CAACQ,CAAC,CAAC,CAAC;IACvD,IAAI,CAACR,UAAU,GAAG,CAAC,CAAC;EACxB;AAEJ,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}