{"ast":null,"code":"// TODO: should not read config outside the mvc package\nimport { config } from '../../config/index.mjs';\nimport $ from './Dom.mjs';\n\n// Special events\n\nconst special = Object.create(null);\nexport default special;\nspecial.load = {\n  // Prevent triggered image.load events from bubbling to window.load\n  noBubble: true\n};\n\n// Create mouseenter/leave events using mouseover/out and event-time checks\n// so that event delegation works in $.\n// Do the same for pointerenter/pointerleave and pointerover/pointerout\n[['mouseenter', 'mouseover'], ['mouseleave', 'mouseout'], ['pointerenter', 'pointerover'], ['pointerleave', 'pointerout']].forEach(([orig, fix]) => {\n  special[orig] = {\n    delegateType: fix,\n    bindType: fix,\n    handle: function (event) {\n      const target = this;\n      const related = event.relatedTarget;\n      const handleObj = event.handleObj;\n      let ret;\n      // For mouseenter/leave call the handler if related is outside the target.\n      // NB: No relatedTarget if the mouse left/entered the browser window\n      if (!related || !target.contains(related)) {\n        event.type = handleObj.origType;\n        ret = handleObj.handler.apply(target, arguments);\n        event.type = fix;\n      }\n      return ret;\n    }\n  };\n});\n\n// Gestures\n\nconst maxDelay = config.doubleTapInterval;\nconst minDelay = 30;\nspecial.dbltap = {\n  bindType: 'touchend',\n  delegateType: 'touchend',\n  handle: function (event, ...args) {\n    const {\n      handleObj,\n      target\n    } = event;\n    const targetData = $.data.create(target);\n    const now = new Date().getTime();\n    const delta = 'lastTouch' in targetData ? now - targetData.lastTouch : 0;\n    if (delta < maxDelay && delta > minDelay) {\n      targetData.lastTouch = null;\n      event.type = handleObj.origType;\n      // let $ handle the triggering of \"dbltap\" event handlers\n      handleObj.handler.call(this, event, ...args);\n    } else {\n      targetData.lastTouch = now;\n    }\n  }\n};","map":{"version":3,"names":["config","$","special","Object","create","load","noBubble","forEach","orig","fix","delegateType","bindType","handle","event","target","related","relatedTarget","handleObj","ret","contains","type","origType","handler","apply","arguments","maxDelay","doubleTapInterval","minDelay","dbltap","args","targetData","data","now","Date","getTime","delta","lastTouch","call"],"sources":["/Users/guankaiyuan/ReactTs/node_modules/.pnpm/@joint+core@4.0.1/node_modules/@joint/core/src/mvc/Dom/events.mjs"],"sourcesContent":["// TODO: should not read config outside the mvc package\nimport { config } from '../../config/index.mjs';\nimport $ from './Dom.mjs';\n\n\n// Special events\n\nconst special = Object.create(null);\n\nexport default special;\n\nspecial.load = {\n    // Prevent triggered image.load events from bubbling to window.load\n    noBubble: true,\n};\n\n// Create mouseenter/leave events using mouseover/out and event-time checks\n// so that event delegation works in $.\n// Do the same for pointerenter/pointerleave and pointerover/pointerout\n[\n    ['mouseenter', 'mouseover'],\n    ['mouseleave', 'mouseout'],\n    ['pointerenter', 'pointerover'],\n    ['pointerleave', 'pointerout'],\n].forEach(([orig, fix]) => {\n    special[orig] = {\n        delegateType: fix,\n        bindType: fix,\n        handle: function(event) {\n            const target = this;\n            const related = event.relatedTarget;\n            const handleObj = event.handleObj;\n            let ret;\n            // For mouseenter/leave call the handler if related is outside the target.\n            // NB: No relatedTarget if the mouse left/entered the browser window\n            if (!related || !target.contains(related)) {\n                event.type = handleObj.origType;\n                ret = handleObj.handler.apply(target, arguments);\n                event.type = fix;\n            }\n            return ret;\n        },\n    };\n});\n\n\n// Gestures\n\nconst maxDelay = config.doubleTapInterval;\nconst minDelay = 30;\n\nspecial.dbltap = {\n    bindType: 'touchend',\n    delegateType: 'touchend',\n    handle: function(event, ...args) {\n        const { handleObj, target } = event;\n        const targetData = $.data.create(target);\n        const now = new Date().getTime();\n        const delta = 'lastTouch' in targetData ? now - targetData.lastTouch : 0;\n        if (delta < maxDelay && delta > minDelay) {\n            targetData.lastTouch = null;\n            event.type = handleObj.origType;\n            // let $ handle the triggering of \"dbltap\" event handlers\n            handleObj.handler.call(this, event, ...args);\n        } else {\n            targetData.lastTouch = now;\n        }\n    }\n};\n"],"mappings":"AAAA;AACA,SAASA,MAAM,QAAQ,wBAAwB;AAC/C,OAAOC,CAAC,MAAM,WAAW;;AAGzB;;AAEA,MAAMC,OAAO,GAAGC,MAAM,CAACC,MAAM,CAAC,IAAI,CAAC;AAEnC,eAAeF,OAAO;AAEtBA,OAAO,CAACG,IAAI,GAAG;EACX;EACAC,QAAQ,EAAE;AACd,CAAC;;AAED;AACA;AACA;AACA,CACI,CAAC,YAAY,EAAE,WAAW,CAAC,EAC3B,CAAC,YAAY,EAAE,UAAU,CAAC,EAC1B,CAAC,cAAc,EAAE,aAAa,CAAC,EAC/B,CAAC,cAAc,EAAE,YAAY,CAAC,CACjC,CAACC,OAAO,CAAC,CAAC,CAACC,IAAI,EAAEC,GAAG,CAAC,KAAK;EACvBP,OAAO,CAACM,IAAI,CAAC,GAAG;IACZE,YAAY,EAAED,GAAG;IACjBE,QAAQ,EAAEF,GAAG;IACbG,MAAM,EAAE,SAAAA,CAASC,KAAK,EAAE;MACpB,MAAMC,MAAM,GAAG,IAAI;MACnB,MAAMC,OAAO,GAAGF,KAAK,CAACG,aAAa;MACnC,MAAMC,SAAS,GAAGJ,KAAK,CAACI,SAAS;MACjC,IAAIC,GAAG;MACP;MACA;MACA,IAAI,CAACH,OAAO,IAAI,CAACD,MAAM,CAACK,QAAQ,CAACJ,OAAO,CAAC,EAAE;QACvCF,KAAK,CAACO,IAAI,GAAGH,SAAS,CAACI,QAAQ;QAC/BH,GAAG,GAAGD,SAAS,CAACK,OAAO,CAACC,KAAK,CAACT,MAAM,EAAEU,SAAS,CAAC;QAChDX,KAAK,CAACO,IAAI,GAAGX,GAAG;MACpB;MACA,OAAOS,GAAG;IACd;EACJ,CAAC;AACL,CAAC,CAAC;;AAGF;;AAEA,MAAMO,QAAQ,GAAGzB,MAAM,CAAC0B,iBAAiB;AACzC,MAAMC,QAAQ,GAAG,EAAE;AAEnBzB,OAAO,CAAC0B,MAAM,GAAG;EACbjB,QAAQ,EAAE,UAAU;EACpBD,YAAY,EAAE,UAAU;EACxBE,MAAM,EAAE,SAAAA,CAASC,KAAK,EAAE,GAAGgB,IAAI,EAAE;IAC7B,MAAM;MAAEZ,SAAS;MAAEH;IAAO,CAAC,GAAGD,KAAK;IACnC,MAAMiB,UAAU,GAAG7B,CAAC,CAAC8B,IAAI,CAAC3B,MAAM,CAACU,MAAM,CAAC;IACxC,MAAMkB,GAAG,GAAG,IAAIC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;IAChC,MAAMC,KAAK,GAAG,WAAW,IAAIL,UAAU,GAAGE,GAAG,GAAGF,UAAU,CAACM,SAAS,GAAG,CAAC;IACxE,IAAID,KAAK,GAAGV,QAAQ,IAAIU,KAAK,GAAGR,QAAQ,EAAE;MACtCG,UAAU,CAACM,SAAS,GAAG,IAAI;MAC3BvB,KAAK,CAACO,IAAI,GAAGH,SAAS,CAACI,QAAQ;MAC/B;MACAJ,SAAS,CAACK,OAAO,CAACe,IAAI,CAAC,IAAI,EAAExB,KAAK,EAAE,GAAGgB,IAAI,CAAC;IAChD,CAAC,MAAM;MACHC,UAAU,CAACM,SAAS,GAAGJ,GAAG;IAC9B;EACJ;AACJ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}