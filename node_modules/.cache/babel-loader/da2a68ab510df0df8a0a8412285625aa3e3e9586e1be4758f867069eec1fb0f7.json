{"ast":null,"code":"import * as mvc from '../mvc/index.mjs';\nimport * as util from '../util/index.mjs';\nimport { CellView } from './CellView.mjs';\nimport { LayersNames } from './PaperLayer.mjs';\nimport { ToolView } from './ToolView.mjs';\nexport const ToolsView = mvc.View.extend({\n  tagName: 'g',\n  className: 'tools',\n  svgElement: true,\n  tools: null,\n  isRendered: false,\n  options: {\n    tools: null,\n    relatedView: null,\n    name: null\n    // layer?: LayersNames.TOOLS\n    // z?: number\n  },\n  configure: function (options) {\n    options = util.assign(this.options, options);\n    var tools = options.tools;\n    if (!Array.isArray(tools)) return this;\n    var relatedView = options.relatedView;\n    if (!(relatedView instanceof CellView)) return this;\n    var views = this.tools = [];\n    for (var i = 0, n = tools.length; i < n; i++) {\n      var tool = tools[i];\n      if (!(tool instanceof ToolView)) continue;\n      tool.configure(relatedView, this);\n      this.vel.append(tool.el);\n      views.push(tool);\n    }\n    this.isRendered = false;\n    relatedView.requestUpdate(relatedView.getFlag('TOOLS'));\n    return this;\n  },\n  getName: function () {\n    return this.options.name;\n  },\n  update: function (opt) {\n    opt || (opt = {});\n    var tools = this.tools;\n    if (!tools) return this;\n    var isRendered = this.isRendered;\n    for (var i = 0, n = tools.length; i < n; i++) {\n      var tool = tools[i];\n      if (!isRendered) {\n        // First update executes render()\n        tool.render();\n      } else if (opt.tool !== tool.cid && tool.isVisible()) {\n        tool.update();\n      }\n    }\n    if (!this.isMounted()) {\n      this.mount();\n    }\n    if (!isRendered) {\n      // Make sure tools are visible (if they were hidden and the tool removed)\n      this.blurTool();\n      this.isRendered = true;\n    }\n    return this;\n  },\n  focusTool: function (focusedTool) {\n    var tools = this.tools;\n    if (!tools) return this;\n    for (var i = 0, n = tools.length; i < n; i++) {\n      var tool = tools[i];\n      if (focusedTool === tool) {\n        tool.show();\n      } else {\n        tool.hide();\n      }\n    }\n    return this;\n  },\n  blurTool: function (blurredTool) {\n    var tools = this.tools;\n    if (!tools) return this;\n    for (var i = 0, n = tools.length; i < n; i++) {\n      var tool = tools[i];\n      if (tool !== blurredTool && !tool.isVisible()) {\n        tool.show();\n        tool.update();\n      }\n    }\n    return this;\n  },\n  hide: function () {\n    return this.focusTool(null);\n  },\n  show: function () {\n    return this.blurTool(null);\n  },\n  onRemove: function () {\n    var tools = this.tools;\n    if (!tools) return this;\n    for (var i = 0, n = tools.length; i < n; i++) {\n      tools[i].remove();\n    }\n    this.tools = null;\n  },\n  mount: function () {\n    const {\n      options,\n      el\n    } = this;\n    const {\n      relatedView,\n      layer = LayersNames.TOOLS,\n      z\n    } = options;\n    if (relatedView) {\n      if (layer) {\n        relatedView.paper.getLayerView(layer).insertSortedNode(el, z);\n      } else {\n        relatedView.el.appendChild(el);\n      }\n    }\n    return this;\n  }\n});","map":{"version":3,"names":["mvc","util","CellView","LayersNames","ToolView","ToolsView","View","extend","tagName","className","svgElement","tools","isRendered","options","relatedView","name","configure","assign","Array","isArray","views","i","n","length","tool","vel","append","el","push","requestUpdate","getFlag","getName","update","opt","render","cid","isVisible","isMounted","mount","blurTool","focusTool","focusedTool","show","hide","blurredTool","onRemove","remove","layer","TOOLS","z","paper","getLayerView","insertSortedNode","appendChild"],"sources":["/Users/guankaiyuan/ReactTs/node_modules/.pnpm/@joint+core@4.0.1/node_modules/@joint/core/src/dia/ToolsView.mjs"],"sourcesContent":["import * as mvc from '../mvc/index.mjs';\nimport * as util from '../util/index.mjs';\nimport { CellView } from './CellView.mjs';\nimport { LayersNames } from './PaperLayer.mjs';\nimport { ToolView } from './ToolView.mjs';\n\nexport const ToolsView = mvc.View.extend({\n    tagName: 'g',\n    className: 'tools',\n    svgElement: true,\n    tools: null,\n    isRendered: false,\n    options: {\n        tools: null,\n        relatedView: null,\n        name: null,\n        // layer?: LayersNames.TOOLS\n        // z?: number\n    },\n\n    configure: function(options) {\n        options = util.assign(this.options, options);\n        var tools = options.tools;\n        if (!Array.isArray(tools)) return this;\n        var relatedView = options.relatedView;\n        if (!(relatedView instanceof CellView)) return this;\n        var views = this.tools = [];\n        for (var i = 0, n = tools.length; i < n; i++) {\n            var tool = tools[i];\n            if (!(tool instanceof ToolView)) continue;\n            tool.configure(relatedView, this);\n            this.vel.append(tool.el);\n            views.push(tool);\n        }\n        this.isRendered = false;\n        relatedView.requestUpdate(relatedView.getFlag('TOOLS'));\n        return this;\n    },\n\n    getName: function() {\n        return this.options.name;\n    },\n\n    update: function(opt) {\n\n        opt || (opt = {});\n        var tools = this.tools;\n        if (!tools) return this;\n        var isRendered = this.isRendered;\n        for (var i = 0, n = tools.length; i < n; i++) {\n            var tool = tools[i];\n            if (!isRendered) {\n                // First update executes render()\n                tool.render();\n            } else if (opt.tool !== tool.cid && tool.isVisible()) {\n                tool.update();\n            }\n        }\n        if (!this.isMounted()) {\n            this.mount();\n        }\n        if (!isRendered) {\n            // Make sure tools are visible (if they were hidden and the tool removed)\n            this.blurTool();\n            this.isRendered = true;\n        }\n        return this;\n    },\n\n    focusTool: function(focusedTool) {\n\n        var tools = this.tools;\n        if (!tools) return this;\n        for (var i = 0, n = tools.length; i < n; i++) {\n            var tool = tools[i];\n            if (focusedTool === tool) {\n                tool.show();\n            } else {\n                tool.hide();\n            }\n        }\n        return this;\n    },\n\n    blurTool: function(blurredTool) {\n        var tools = this.tools;\n        if (!tools) return this;\n        for (var i = 0, n = tools.length; i < n; i++) {\n            var tool = tools[i];\n            if (tool !== blurredTool && !tool.isVisible()) {\n                tool.show();\n                tool.update();\n            }\n        }\n        return this;\n    },\n\n    hide: function() {\n        return this.focusTool(null);\n    },\n\n    show: function() {\n        return this.blurTool(null);\n    },\n\n    onRemove: function() {\n        var tools = this.tools;\n        if (!tools) return this;\n        for (var i = 0, n = tools.length; i < n; i++) {\n            tools[i].remove();\n        }\n        this.tools = null;\n    },\n\n    mount: function() {\n        const { options, el } = this;\n        const { relatedView, layer = LayersNames.TOOLS, z } = options;\n        if (relatedView) {\n            if (layer) {\n                relatedView.paper.getLayerView(layer).insertSortedNode(el, z);\n            } else {\n                relatedView.el.appendChild(el);\n            }\n        }\n        return this;\n    }\n\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}